#VRML_SIM R2023b utf8
PROTO WheelchairRobotV2 [
  field SFVec3f translation 0 0 0               # Position of the wheelchair
  field SFRotation rotation 0 1 0 0             # Orientation of the wheelchair
  field SFColor color 0.5 0.5 0.5               # Color of the wheelchair frame
  field SFFloat wheelRadius 0.05                # Radius of the wheels
  field SFFloat wheelWidth 0.2                  # Width of the wheels
  field SFVec3f seatSize 0.4 0.1 0.4            # Dimensions of the seat
  field SFFloat wheelMotorMaxForce 10.0         # Maximum force of the wheel motors
  field SFFloat wheelMotorMaxVelocity 5.0       # Maximum velocity of the wheel motors
  field MFVec3f sensorRange  [ ]                # Range of the distance sensors
] {
  Robot {
    translation IS translation
    rotation IS rotation
    children [
      # Chassis
      Shape {
        appearance Appearance {
          material Material {
            diffuseColor IS color
          }
        }
        geometry Box {
          size IS seatSize
        }
      }

      # Left Motorized Wheel
      HingeJoint {
        jointParameters HingeJointParameters {
          axis 0 1 0
          anchor 0 0 0.15
        }
        device [
          RotationalMotor {
            name "left_wheel_motor"
            maxVelocity IS wheelMotorMaxVelocity
            maxTorque IS wheelMotorMaxForce
          }
        ]
        endPoint Solid {
          children [
            Shape {
              appearance Appearance {
                material Material {
                  diffuseColor 0.1 0.1 0.1
                }
              }
              geometry Cylinder {
                radius IS wheelRadius
                height IS wheelWidth
                subdivision 32
              }
            }
          ]
          name "obj1"
        }
      }

      # Right Motorized Wheel
      HingeJoint {
        jointParameters HingeJointParameters {
          axis 0 1 0
          anchor 0 0 -0.15
        }
        device [
          RotationalMotor {
            name "right_wheel_motor"
            maxVelocity IS wheelMotorMaxVelocity
            maxTorque IS wheelMotorMaxForce
          }
        ]
        endPoint Solid {
          children [
            Shape {
              appearance Appearance {
                material Material {
                  diffuseColor 0.1 0.1 0.1
                }
              }
              geometry Cylinder {
                radius IS wheelRadius
                height IS wheelWidth
                subdivision 32
              }
            }
          ]
          name "obj2"
        }
      }

      # Distance Sensors (Front, Left, and Right)
      DistanceSensor {
        name "front_distance_sensor"
        translation 0.2 0 0
        rotation 0 1 0 0
        lookupTable IS sensorRange
      }
      DistanceSensor {
        name "left_distance_sensor"
        translation 0 0 0.2
        rotation 0 1 0 1.57  # Rotate to face left
        lookupTable IS sensorRange
      }
      DistanceSensor {
        name "right_distance_sensor"
        translation 0 0 -0.2
        rotation 0 1 0 -1.57  # Rotate to face right
        lookupTable IS sensorRange
      }
    ]
    controller "wheelchair_V1_C" # Replace with your actual controller name
  }
}
